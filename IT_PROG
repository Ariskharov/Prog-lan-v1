улучшенная версия в ветке master
